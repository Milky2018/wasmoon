# Wasmoon Roadmap

WebAssembly Runtime in MoonBit - å¼€å‘è·¯çº¿å›¾

## é¡¹ç›®æ¦‚è¿°

Wasmoon æ˜¯ä¸€ä¸ªç”¨ MoonBit ç¼–å†™çš„ WebAssembly è¿è¡Œæ—¶ï¼Œç›®æ ‡æ˜¯å®ç°ä¸€ä¸ªå®Œæ•´çš„ WASM è§£é‡Šå™¨ï¼Œæ”¯æŒ WebAssembly 1.0 è§„èŒƒçš„æ ¸å¿ƒç‰¹æ€§ã€‚

## Phase 1: MVP âœ… å·²å®Œæˆ

### 1.1 æ ¸å¿ƒæ•°æ®ç»“æ„ âœ…
- [x] å€¼ç±»å‹å®šä¹‰ (I32, I64, F32, F64, FuncRef, ExternRef)
- [x] æŒ‡ä»¤é›†æšä¸¾ (190+ æŒ‡ä»¤å˜ä½“)
- [x] æ¨¡å—ç»“æ„ (Module, FuncType, Export, Import ç­‰)

### 1.2 äºŒè¿›åˆ¶æ ¼å¼è§£æå™¨ âœ…
- [x] é­”æ•°å’Œç‰ˆæœ¬éªŒè¯
- [x] LEB128 ç¼–ç è§£ç 
- [x] 11 ç§ Section è§£æ
- [x] IEEE 754 æµ®ç‚¹æ•°è§£ç  (f32/f64)

### 1.3 è¿è¡Œæ—¶æ•°æ®ç»“æ„ âœ…
- [x] æ“ä½œæ•°æ ˆ (Stack)
- [x] çº¿æ€§å†…å­˜ (Memory)
- [x] å‡½æ•°å¼•ç”¨è¡¨ (Table)
- [x] å…¨å±€å˜é‡ (GlobalInstance)
- [x] è°ƒç”¨å¸§ (Frame)
- [x] å…¨å±€å­˜å‚¨ (Store)
- [x] æ¨¡å—å®ä¾‹ (ModuleInstance)

### 1.4 åŸºç¡€æ‰§è¡Œå¼•æ“ âœ…
- [x] i32 ç®—æœ¯/æ¯”è¾ƒ/ä½è¿ç®—
- [x] å¸¸é‡æŒ‡ä»¤
- [x] å±€éƒ¨å˜é‡æ“ä½œ
- [x] åŸºæœ¬æ§åˆ¶æµ

---

## Phase 2: æ ¸å¿ƒåŠŸèƒ½æ‰©å±• âœ… å·²å®Œæˆ

### 2.1 å®Œæ•´çš„æ•°å€¼è¿ç®— âœ…
- [x] i64 ç®—æœ¯/æ¯”è¾ƒ/ä½è¿ç®—
- [x] f32/f64 æµ®ç‚¹è¿ç®—
- [x] æ•°å€¼è½¬æ¢æŒ‡ä»¤ (wrap, extend, trunc, convert, reinterpret)
- [x] é¥±å’Œè½¬æ¢æŒ‡ä»¤ (trunc_sat)

### 2.2 å†…å­˜æ“ä½œ âœ…
- [x] å®Œæ•´çš„ load/store æŒ‡ä»¤æ—
- [x] æ‰©å±•çš„ load æŒ‡ä»¤ (load8_s, load8_u, load16_s, load16_u, load32_s, load32_u)
- [x] memory.size å’Œ memory.grow

### 2.3 æ§åˆ¶æµ âœ…
- [x] ç»“æ„åŒ–æ§åˆ¶æµ (block, loop, if-else)
- [x] åˆ†æ”¯æŒ‡ä»¤ (br, br_if, br_table)
- [x] select æŒ‡ä»¤

### 2.4 å‡½æ•°è°ƒç”¨ âœ…
- [x] ç›´æ¥å‡½æ•°è°ƒç”¨ (call)
- [x] é—´æ¥å‡½æ•°è°ƒç”¨ (call_indirect)

---

## Phase 3: å®Œæ•´çš„ WASM 1.0 æ”¯æŒ ğŸ“¦

### 3.1 å…¨å±€å˜é‡ âœ…
- [x] global.get / global.set
- [x] å…¨å±€å˜é‡åˆå§‹åŒ–è¡¨è¾¾å¼

### 3.2 å¯¼å…¥å¯¼å‡º
- [x] å‡½æ•°å¯¼å…¥/å¯¼å‡º
- [x] ä¸»æœºå‡½æ•°æ¥å£ (Host Functions)
- [x] å†…å­˜å¯¼å…¥/å¯¼å‡º
- [x] è¡¨å¯¼å…¥/å¯¼å‡º
- [x] å…¨å±€å˜é‡å¯¼å…¥/å¯¼å‡º

### 3.3 è¡¨æ“ä½œ âœ…
- [x] table.get / table.set
- [x] table.size / table.grow
- [x] table.fill / table.copy

### 3.4 æ¨¡å—åˆå§‹åŒ– âœ…
- [x] Start function æ‰§è¡Œ
- [x] æ•°æ®æ®µåˆå§‹åŒ– (data segment)
- [x] å…ƒç´ æ®µåˆå§‹åŒ– (element segment)

### 3.5 æ‰¹é‡å†…å­˜æ“ä½œ âœ…
- [x] memory.init / memory.copy / memory.fill
- [x] data.drop / elem.drop

### 3.6 å¼•ç”¨ç±»å‹ âœ…
- [x] ref.null / ref.is_null / ref.func

### 3.7 å¤šè¿”å›å€¼ âœ…
- [x] å‡½æ•°å¤šè¿”å›å€¼æ”¯æŒ
- [x] block/if å¤šè¿”å›å€¼æ”¯æŒ

---

## Phase 4: æ¨¡å—éªŒè¯ä¸é“¾æ¥ ğŸ”—

### 4.1 æ¨¡å—éªŒè¯å™¨
- [x] ç±»å‹æ£€æŸ¥
- [x] æ ˆé«˜åº¦éªŒè¯
- [x] æ§åˆ¶æµéªŒè¯

### 4.2 å¤šæ¨¡å—æ”¯æŒ
- [x] æ¨¡å—é“¾æ¥
- [x] ç¬¦å·è§£æ

---

## Phase 5: å·¥å…·ä¸æµ‹è¯• ğŸ› ï¸

### 5.1 è§„èŒƒå…¼å®¹æ€§
- [ ] é€šè¿‡å®˜æ–¹æµ‹è¯•å¥—ä»¶ (wasm-testsuite)

### 5.2 å·¥å…·é“¾
- [ ] WAT æ–‡æœ¬æ ¼å¼æ”¯æŒ
- [ ] WASM åæ±‡ç¼–å™¨

---

## Phase 6: æ€§èƒ½ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰âš¡

### 6.1 è§£é‡Šå™¨ä¼˜åŒ–
- [ ] æŒ‡ä»¤åˆ†æ´¾ä¼˜åŒ–
- [ ] æ ˆç¼“å­˜ä¼˜åŒ–
- [ ] çƒ­ç‚¹å‡½æ•°è¯†åˆ«

### 6.2 åŸºå‡†æµ‹è¯•
- [ ] åŸºå‡†æµ‹è¯•å¥—ä»¶
- [ ] æ€§èƒ½å¯¹æ¯”åˆ†æ

---

## Phase 7: æ‰©å±•ææ¡ˆï¼ˆå¯é€‰ï¼‰ğŸš€

### 7.1 WASM 2.0+ ç‰¹æ€§
- [ ] å°¾è°ƒç”¨ (tail-call)
- [ ] å¼‚å¸¸å¤„ç† (exception-handling)

### 7.2 é«˜çº§ææ¡ˆ
- [ ] SIMD (v128)
- [ ] çº¿ç¨‹ (threads)

---

## å‚è€ƒèµ„æº

- [WebAssembly Specification](https://webassembly.github.io/spec/)
- [WASM Binary Encoding](https://webassembly.github.io/spec/core/binary/index.html)
- [WASM Semantics](https://webassembly.github.io/spec/core/exec/index.html)

---

**å½“å‰çŠ¶æ€**: Phase 5 è¿›è¡Œä¸­
**ä¸‹ä¸€æ­¥**: é€šè¿‡å®˜æ–¹æµ‹è¯•å¥—ä»¶ (wasm-testsuite)
