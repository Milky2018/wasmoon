# Wasmoon Roadmap

WebAssembly Runtime in MoonBit - å¼€å‘è·¯çº¿å›¾

## é¡¹ç›®æ¦‚è¿°

Wasmoon æ˜¯ä¸€ä¸ªç”¨ MoonBit ç¼–å†™çš„ WebAssembly è¿è¡Œæ—¶ï¼Œç›®æ ‡æ˜¯å®ç°ä¸€ä¸ªå®Œæ•´çš„ WASM è§£é‡Šå™¨å’Œ JIT ç¼–è¯‘å™¨ï¼Œæ”¯æŒ WebAssembly è§„èŒƒçš„æ ¸å¿ƒç‰¹æ€§ï¼Œå¹¶æœ€ç»ˆå®ç°ç±»ä¼¼ Cranelift çš„ä»£ç ç”Ÿæˆå™¨ã€‚

## Phase 1: MVP âœ… å·²å®Œæˆ

### 1.1 æ ¸å¿ƒæ•°æ®ç»“æ„ âœ…
- [x] å€¼ç±»å‹å®šä¹‰ (I32, I64, F32, F64, FuncRef, ExternRef)
- [x] æŒ‡ä»¤é›†æšä¸¾ (190+ æŒ‡ä»¤å˜ä½“)
- [x] æ¨¡å—ç»“æ„ (Module, FuncType, Export, Import ç­‰)

### 1.2 äºŒè¿›åˆ¶æ ¼å¼è§£æå™¨ âœ…
- [x] é­”æ•°å’Œç‰ˆæœ¬éªŒè¯
- [x] LEB128 ç¼–ç è§£ç 
- [x] 11 ç§ Section è§£æ
- [x] IEEE 754 æµ®ç‚¹æ•°è§£ç  (f32/f64)

### 1.3 è¿è¡Œæ—¶æ•°æ®ç»“æ„ âœ…
- [x] æ“ä½œæ•°æ ˆ (Stack)
- [x] çº¿æ€§å†…å­˜ (Memory)
- [x] å‡½æ•°å¼•ç”¨è¡¨ (Table)
- [x] å…¨å±€å˜é‡ (GlobalInstance)
- [x] è°ƒç”¨å¸§ (Frame)
- [x] å…¨å±€å­˜å‚¨ (Store)
- [x] æ¨¡å—å®ä¾‹ (ModuleInstance)

### 1.4 åŸºç¡€æ‰§è¡Œå¼•æ“ âœ…
- [x] i32 ç®—æœ¯/æ¯”è¾ƒ/ä½è¿ç®—
- [x] å¸¸é‡æŒ‡ä»¤
- [x] å±€éƒ¨å˜é‡æ“ä½œ
- [x] åŸºæœ¬æ§åˆ¶æµ

---

## Phase 2: æ ¸å¿ƒåŠŸèƒ½æ‰©å±• âœ… å·²å®Œæˆ

### 2.1 å®Œæ•´çš„æ•°å€¼è¿ç®— âœ…
- [x] i64 ç®—æœ¯/æ¯”è¾ƒ/ä½è¿ç®—
- [x] f32/f64 æµ®ç‚¹è¿ç®—
- [x] æ•°å€¼è½¬æ¢æŒ‡ä»¤ (wrap, extend, trunc, convert, reinterpret)
- [x] é¥±å’Œè½¬æ¢æŒ‡ä»¤ (trunc_sat)

### 2.2 å†…å­˜æ“ä½œ âœ…
- [x] å®Œæ•´çš„ load/store æŒ‡ä»¤æ—
- [x] æ‰©å±•çš„ load æŒ‡ä»¤ (load8_s, load8_u, load16_s, load16_u, load32_s, load32_u)
- [x] memory.size å’Œ memory.grow

### 2.3 æ§åˆ¶æµ âœ…
- [x] ç»“æ„åŒ–æ§åˆ¶æµ (block, loop, if-else)
- [x] åˆ†æ”¯æŒ‡ä»¤ (br, br_if, br_table)
- [x] select æŒ‡ä»¤

### 2.4 å‡½æ•°è°ƒç”¨ âœ…
- [x] ç›´æ¥å‡½æ•°è°ƒç”¨ (call)
- [x] é—´æ¥å‡½æ•°è°ƒç”¨ (call_indirect)

---

## Phase 3: å®Œæ•´çš„ WASM 1.0 æ”¯æŒ âœ… å·²å®Œæˆ

### 3.1 å…¨å±€å˜é‡ âœ…
- [x] global.get / global.set
- [x] å…¨å±€å˜é‡åˆå§‹åŒ–è¡¨è¾¾å¼

### 3.2 å¯¼å…¥å¯¼å‡º âœ…
- [x] å‡½æ•°å¯¼å…¥/å¯¼å‡º
- [x] ä¸»æœºå‡½æ•°æ¥å£ (Host Functions)
- [x] å†…å­˜å¯¼å…¥/å¯¼å‡º
- [x] è¡¨å¯¼å…¥/å¯¼å‡º
- [x] å…¨å±€å˜é‡å¯¼å…¥/å¯¼å‡º

### 3.3 è¡¨æ“ä½œ âœ…
- [x] table.get / table.set
- [x] table.size / table.grow
- [x] table.fill / table.copy

### 3.4 æ¨¡å—åˆå§‹åŒ– âœ…
- [x] Start function æ‰§è¡Œ
- [x] æ•°æ®æ®µåˆå§‹åŒ– (data segment)
- [x] å…ƒç´ æ®µåˆå§‹åŒ– (element segment)

### 3.5 æ‰¹é‡å†…å­˜æ“ä½œ âœ…
- [x] memory.init / memory.copy / memory.fill
- [x] data.drop / elem.drop

### 3.6 å¼•ç”¨ç±»å‹ âœ…
- [x] ref.null / ref.is_null / ref.func

### 3.7 å¤šè¿”å›å€¼ âœ…
- [x] å‡½æ•°å¤šè¿”å›å€¼æ”¯æŒ
- [x] block/if å¤šè¿”å›å€¼æ”¯æŒ

---

## Phase 4: æ¨¡å—éªŒè¯ä¸é“¾æ¥ âœ… å·²å®Œæˆ

### 4.1 æ¨¡å—éªŒè¯å™¨ âœ…
- [x] ç±»å‹æ£€æŸ¥
- [x] æ ˆé«˜åº¦éªŒè¯
- [x] æ§åˆ¶æµéªŒè¯
- [x] å†…å­˜é™åˆ¶éªŒè¯
- [x] å¤šå†…å­˜/å¤šè¡¨æ£€æŸ¥ (MVP é™åˆ¶)

### 4.2 å¤šæ¨¡å—æ”¯æŒ âœ…
- [x] æ¨¡å—é“¾æ¥
- [x] ç¬¦å·è§£æ

---

## Phase 5: å·¥å…·ä¸æµ‹è¯• âœ… å·²å®Œæˆ

### 5.1 è§„èŒƒå…¼å®¹æ€§ âœ…
- [x] å®˜æ–¹æµ‹è¯•å¥—ä»¶åŸºç¡€è®¾æ–½ (wasm-testsuite)
- [x] è‡ªåŠ¨åŒ–æµ‹è¯•è¿è¡Œå™¨ (è§£æ JSON æµ‹è¯•è§„èŒƒï¼Œè‡ªåŠ¨æ‰§è¡Œæµ‹è¯•)
  - ç”¨æ³•: `moon run cmd/main -- test testsuite/data/i32.json`
- [x] å®Œæ•´é€šè¿‡å®˜æ–¹æµ‹è¯•å¥—ä»¶ (5955 tests passed, 0 failed)

### 5.2 å·¥å…·é“¾
- [x] WASM åæ±‡ç¼–å™¨
- [x] WAT æ–‡æœ¬æ ¼å¼æ”¯æŒ
  - [x] åŸºæœ¬ WAT è§£æ (flat form)
  - [x] WAT folded form è¯­æ³•æ”¯æŒ (then/else keywords in if expressions)

### 5.3 å‘½ä»¤è¡Œå·¥å…· (å¯¹é½ wasmtime CLI)

> å‚è€ƒ `wasmtime --help` å®ç°å®Œæ•´çš„å‘½ä»¤è¡Œæ¥å£

#### æ ¸å¿ƒå‘½ä»¤
- [x] `run` - è¿è¡Œ WebAssembly æ¨¡å—
  - [x] ç›´æ¥è¿è¡Œ `.wasm` æ–‡ä»¶
  - [x] `--invoke <FUNCTION>` æŒ‡å®šå…¥å£å‡½æ•°
  - [x] ä¼ é€’å‘½ä»¤è¡Œå‚æ•°ç»™ WASM æ¨¡å— (`--arg`)
  - [x] `--preload <NAME=MODULE>` é¢„åŠ è½½æ¨¡å—
- [x] `compile` - é¢„ç¼–è¯‘ WebAssembly æ¨¡å— (AOT)
  - [x] è¾“å‡º `.cwasm` é¢„ç¼–è¯‘æ ¼å¼
  - [x] `-o, --output <PATH>` æŒ‡å®šè¾“å‡ºè·¯å¾„
  - [x] `--emit-ir <PATH>` è¾“å‡º IR
- [x] `wast` - è¿è¡Œ WebAssembly æµ‹è¯•è„šæœ¬
  - [x] æ”¯æŒ `.wast` æ ¼å¼æµ‹è¯•æ–‡ä»¶
  - [x] å¯æ›¿ä»£å½“å‰çš„ JSON æµ‹è¯•æ ¼å¼

#### ç°æœ‰å‘½ä»¤ (å·²å®ç°)
- [x] `test` - è¿è¡Œ JSON æ ¼å¼æµ‹è¯• (å½“å‰å®ç°)
- [x] `disasm` - åæ±‡ç¼– WASM æ–‡ä»¶
- [x] `wat` - è§£æ WAT æ–‡ä»¶
- [x] `demo` - è¿è¡Œå†…ç½®ç¤ºä¾‹

#### æ£€æŸ¥ä¸æ¢ç´¢å‘½ä»¤
- [x] `explore` - æ¢ç´¢ WASM ç¼–è¯‘è¿‡ç¨‹
  - [x] æ˜¾ç¤ºç¼–è¯‘å„é˜¶æ®µè¾“å‡º (WASM â†’ IR â†’ VCode â†’ å¯„å­˜å™¨åˆ†é…)
  - [ ] è¾“å‡º HTML æŠ¥å‘Š (å¯é€‰ï¼Œæœªæ¥å¢å¼º)
- [x] `objdump` - æ£€æŸ¥é¢„ç¼–è¯‘çš„ `.cwasm` æ–‡ä»¶
  - [x] æ˜¾ç¤ºå…ƒæ•°æ®
  - [x] æ˜¾ç¤ºæ®µä¿¡æ¯

#### é…ç½®ä¸è°ƒè¯•é€‰é¡¹
- [x] `-O, --optimize` ä¼˜åŒ–é€‰é¡¹
  - [x] ä¼˜åŒ–çº§åˆ« (0-3)
  - [ ] ç‰¹å®šä¼˜åŒ–å¼€å…³
- [ ] `-D, --debug <KEY=VAL>` è°ƒè¯•é€‰é¡¹
  - [ ] è¯¦ç»†æ—¥å¿—è¾“å‡º
  - [ ] IR æ‰“å°
- [ ] `-W, --wasm <KEY=VAL>` WASM è¯­ä¹‰é€‰é¡¹
  - [ ] å¯ç”¨/ç¦ç”¨ç‰¹å®šææ¡ˆ
  - [ ] å†…å­˜é™åˆ¶é…ç½®

#### WASI æ”¯æŒ (å‚è§ Phase 12)
- [ ] CLI é€‰é¡¹ (`--dir`, `--env`, `-S`) - ä¾èµ– Phase 12 WASI æ ¸å¿ƒå®ç°

#### è¾…åŠ©å‘½ä»¤
- [ ] `config` - é…ç½®ç®¡ç†
  - [ ] `--config <FILE>` ä½¿ç”¨ TOML é…ç½®æ–‡ä»¶
- [x] `settings` - æ˜¾ç¤ºå¯ç”¨çš„ç¼–è¯‘å™¨è®¾ç½®
- [x] `completion` - ç”Ÿæˆ shell è¡¥å…¨è„šæœ¬
  - [x] æ”¯æŒ bash, zsh, fish

---

## Phase 6: ä¸­é—´è¡¨ç¤ºå±‚ (IR) âœ… å·²å®Œæˆ

> è¿™æ˜¯å®ç° JIT ç¼–è¯‘å™¨çš„åŸºç¡€ï¼Œå‚è€ƒ [Cranelift](https://cranelift.dev/) çš„è®¾è®¡

### 6.1 é«˜çº§ IR (ç±»ä¼¼ CLIF)
- [x] SSA (Static Single Assignment) å½¢å¼çš„ IR å®šä¹‰
- [x] åŸºæœ¬å— (Basic Block) æ•°æ®ç»“æ„
- [x] æ§åˆ¶æµå›¾ (CFG) æ„å»º
- [x] IR ç±»å‹ç³»ç»Ÿ (ä¸ WASM ç±»å‹å¯¹åº”)
- [x] IR æŒ‡ä»¤é›†å®šä¹‰
  - [x] ç®—æœ¯è¿ç®—æŒ‡ä»¤
  - [x] å†…å­˜è®¿é—®æŒ‡ä»¤
  - [x] æ§åˆ¶æµæŒ‡ä»¤
  - [x] å‡½æ•°è°ƒç”¨æŒ‡ä»¤
- [x] IR Builder API (ç±»ä¼¼ Cranelift FunctionBuilder)
- [x] IR æ–‡æœ¬æ ¼å¼æ‰“å°å™¨

### 6.2 WASM åˆ° IR çš„è½¬æ¢
- [x] WASM æŒ‡ä»¤åˆ° IR æŒ‡ä»¤çš„æ˜ å°„
- [x] æ ˆæœºæ¨¡å‹åˆ°å¯„å­˜å™¨æ¨¡å‹çš„è½¬æ¢
- [x] æ§åˆ¶æµé‡å»º (block/loop/if åˆ° CFG)
- [x] å±€éƒ¨å˜é‡å’Œå‚æ•°å¤„ç†

### 6.3 IR éªŒè¯
- [x] SSA å±æ€§éªŒè¯
- [x] ç±»å‹ä¸€è‡´æ€§æ£€æŸ¥
- [x] æ§åˆ¶æµå®Œæ•´æ€§éªŒè¯

---

## Phase 7: IR ä¼˜åŒ– ğŸ”¨ è¿›è¡Œä¸­

> åœ¨é«˜çº§ IR ä¸Šè¿›è¡Œç›®æ ‡æ— å…³çš„ä¼˜åŒ–

### 7.1 åŸºç¡€ä¼˜åŒ–
- [x] æ­»ä»£ç æ¶ˆé™¤ (Dead Code Elimination)
- [x] å¸¸é‡æŠ˜å  (Constant Folding)
- [x] å¸¸é‡ä¼ æ’­ (Constant Propagation)
- [x] å¤åˆ¶ä¼ æ’­ (Copy Propagation)
- [x] å…¬å…±å­è¡¨è¾¾å¼æ¶ˆé™¤ (CSE)

### 7.2 æ§åˆ¶æµä¼˜åŒ–
- [x] åˆ†æ”¯ç®€åŒ–
- [x] ä¸å¯è¾¾ä»£ç æ¶ˆé™¤
- [x] åŸºæœ¬å—åˆå¹¶
- [x] è·³è½¬çº¿ç¨‹åŒ– (Jump Threading)

### 7.3 å¾ªç¯ä¼˜åŒ–
- [x] å¾ªç¯ä¸å˜ä»£ç å¤–æ (LICM)
- [x] å¾ªç¯å±•å¼€ (Loop Unrolling)
- [x] å¼ºåº¦å‰Šå‡ (Strength Reduction)

### 7.4 é«˜çº§ä¼˜åŒ– (å¯é€‰)
- [ ] E-graph ç»Ÿä¸€ä¼˜åŒ–æ¡†æ¶ (å‚è€ƒ Cranelift çš„åˆ›æ–°è®¾è®¡)
- [ ] å†…è” (Inlining)
- [ ] å°¾è°ƒç”¨ä¼˜åŒ–

---

## Phase 8: ä½çº§ IR ä¸æŒ‡ä»¤é€‰æ‹© ğŸ”¨ è¿›è¡Œä¸­

> ç±»ä¼¼ Cranelift çš„ VCodeï¼Œç›®æ ‡ç›¸å…³çš„ä½çº§è¡¨ç¤º

### 8.1 ä½çº§ IR (VCode) è®¾è®¡ âœ…
- [x] è™šæ‹Ÿå¯„å­˜å™¨è¡¨ç¤º
- [x] ç›®æ ‡ç›¸å…³çš„æŒ‡ä»¤æ ¼å¼
- [x] é SSA å½¢å¼ (å…è®¸é‡å®šä¹‰)
- [x] å¯„å­˜å™¨çº¦æŸè¡¨ç¤º
  - [x] åŸºæœ¬å¯„å­˜å™¨ç±»å‹ (Int/Float)
  - [ ] æ“ä½œæ•°çº¦æŸç³»ç»Ÿ (`OperandKind::Use/Def/UseDef`, `OperandConstraint::Any/Fixed/Reuse` å·²å®šä¹‰ä½†æœªä½¿ç”¨)

### 8.2 æŒ‡ä»¤é€‰æ‹© (Lowering) âœ…
- [x] é«˜çº§ IR åˆ°ä½çº§ IR çš„è½¬æ¢æ¡†æ¶
- [x] æ¨¡å¼åŒ¹é…è§„åˆ™å®šä¹‰ (ç±»ä¼¼ ISLE DSL)
- [x] æŒ‡ä»¤åˆå¹¶ä¸ä¼˜åŒ–
- [x] ç›®æ ‡ç‰¹å®šçš„æŒ‡ä»¤é€‰æ‹©è§„åˆ™

### 8.3 ç›®æ ‡æ¶æ„æŠ½è±¡ âœ…
- [x] ç›®æ ‡æ¶æ„æ¥å£ (TargetISA trait)
- [x] å¯„å­˜å™¨æè¿°
- [x] è°ƒç”¨çº¦å®š (Calling Convention)
  - [x] é»˜è®¤è°ƒç”¨çº¦å®šå®ç°
  - [ ] å¤šè°ƒç”¨çº¦å®šæ”¯æŒ (`SystemV`, `Aapcs64`, `WindowsFastcall`, `Wasm` å·²å®šä¹‰ä½†æœªä½¿ç”¨)
- [x] æŒ‡ä»¤ç¼–ç è§„åˆ™

---

## Phase 9: å¯„å­˜å™¨åˆ†é… âœ… å·²å®Œæˆ

> å°†è™šæ‹Ÿå¯„å­˜å™¨æ˜ å°„åˆ°ç‰©ç†å¯„å­˜å™¨

### 9.1 æ´»è·ƒæ€§åˆ†æ âœ…
- [x] æ´»è·ƒåŒºé—´ (Live Interval) è®¡ç®—
- [x] ä½¿ç”¨-å®šä¹‰é“¾ (Use-Def Chain)

### 9.2 å¯„å­˜å™¨åˆ†é…ç®—æ³• âœ…
- [x] çº¿æ€§æ‰«æåˆ†é…å™¨ (Linear Scan)
- [x] æº¢å‡ºå¤„ç† (Spilling)
- [x] é‡æ–°åŠ è½½ (Reloading)
- [ ] å¯„å­˜å™¨åˆå¹¶ (Coalescing)

### 9.3 æ ˆå¸ƒå±€ âœ…
- [x] æ ˆå¸§å¸ƒå±€è®¡ç®—
- [x] æº¢å‡ºæ§½åˆ†é…
  - [x] åŸºæœ¬æº¢å‡ºæ§½ç±»å‹ (`Spill`, `Arg`)
  - [ ] å®Œæ•´æ ˆæ§½ç±»å‹ (`ReturnAddress` å·²å®šä¹‰ä½†æœªä½¿ç”¨)
- [x] è°ƒç”¨è€…/è¢«è°ƒç”¨è€…ä¿å­˜å¯„å­˜å™¨å¤„ç†
  - [x] åŸºæœ¬åºè¨€/å°¾å£°ç”Ÿæˆ
  - [ ] å®Œæ•´åºè¨€æ“ä½œ (`AdjustSP`, `PushReg`, `PopReg` å·²å®šä¹‰ä½†æœªä½¿ç”¨)

---

## Phase 10: ä»£ç ç”Ÿæˆ ğŸ’»

> ç”Ÿæˆç›®æ ‡å¹³å°çš„æœºå™¨ä»£ç 

### 10.1 x86-64 åç«¯ï¼ˆä½ä¼˜å…ˆï¼‰
- [ ] æŒ‡ä»¤ç¼–ç 
- [ ] å¯»å€æ¨¡å¼
- [ ] æ¡ä»¶ç å¤„ç†
- [ ] æµ®ç‚¹æŒ‡ä»¤ (SSE/AVX)

### 10.2 AArch64 åç«¯ âœ…
- [x] æŒ‡ä»¤ç¼–ç 
  - [x] 64ä½æ•´æ•°è¿ç®— (ADD, SUB, MUL, SDIV, UDIV)
  - [x] 64ä½æµ®ç‚¹è¿ç®— (FADD, FSUB, FMUL, FDIV)
  - [x] 64ä½/32ä½å†…å­˜æ“ä½œ (LDR, STR)
  - [ ] 8ä½/16ä½å†…å­˜æ“ä½œ (`MemType::I8/I16` å·²å®šä¹‰ä½†æœªä½¿ç”¨)
- [x] å¯„å­˜å™¨ä½¿ç”¨
- [x] æ¡ä»¶æ‰§è¡Œ
- [x] AArch64 ç‰¹æœ‰æŒ‡ä»¤é€‰æ‹©
  - [x] ä¹˜åŠ /ä¹˜å‡æŒ‡ä»¤ (MADD, MSUB, MNEG)
  - [x] å¸¦ç§»ä½æ“ä½œæ•°æŒ‡ä»¤ (ADD/SUB/AND/OR/XOR shifted)
- [ ] æ‰©å±•æŒ‡ä»¤ (`ExtendKind::Signed8To32/Signed8To64/...` å·²å®šä¹‰ä½†æœªä½¿ç”¨)

### 10.3 ä»£ç å‘å°„ âœ…
- [x] æœºå™¨ç ç¼“å†²åŒº
- [x] é‡å®šä½å¤„ç†
- [x] åˆ†æ”¯åç§»è®¡ç®—
- [x] ä»£ç å¯¹é½

### 10.4 è¿è¡Œæ—¶æ”¯æŒ âœ…
- [x] JIT ä»£ç ç¼“å­˜
- [x] å¯æ‰§è¡Œå†…å­˜ç®¡ç†
- [x] ä»£ç å¸è½½

---

## Phase 11: JIT è¿è¡Œæ—¶é›†æˆ ğŸš€

> å°† JIT ç¼–è¯‘å™¨é›†æˆåˆ° WASM è¿è¡Œæ—¶

### 11.1 ç¼–è¯‘ç­–ç•¥ âœ…
- [x] è§£é‡Šæ‰§è¡Œ + JIT æ··åˆæ¨¡å¼
- [x] çƒ­ç‚¹æ£€æµ‹ (Profiling)
- [x] åˆ†å±‚ç¼–è¯‘ (Tiered Compilation)
- [x] æ‡’ç¼–è¯‘ (Lazy Compilation)

### 11.2 è¿è¡Œæ—¶æ¥å£ ğŸ”¨
- [x] ç¼–è¯‘å‡½æ•°è°ƒç”¨
- [x] è§£é‡Šå™¨åˆ° JIT ä»£ç çš„åˆ‡æ¢
- [ ] å †æ ˆæ›¿æ¢ (On-Stack Replacement)

### 11.3 è°ƒè¯•æ”¯æŒ âœ…
- [x] æºç æ˜ å°„
- [x] æ–­ç‚¹æ”¯æŒ
  - [x] æ–­ç‚¹ç®¡ç† API
  - [ ] å®Œæ•´è°ƒè¯•å‘½ä»¤ (`StepInto`, `StepOver`, `StepOut` å·²å®šä¹‰ä½†æœªä½¿ç”¨)
- [x] å †æ ˆè·Ÿè¸ª

---

## Phase 12: WASI æ”¯æŒ ğŸ“‹

> WebAssembly System Interface - ä½¿ WASM æ¨¡å—èƒ½å¤Ÿä¸æ“ä½œç³»ç»Ÿäº¤äº’

### 12.1 WASI Preview 1 (wasi_snapshot_preview1)
- [ ] æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
  - [ ] `fd_read` / `fd_write` - æ–‡ä»¶æè¿°ç¬¦è¯»å†™
  - [ ] `fd_seek` / `fd_tell` - æ–‡ä»¶å®šä½
  - [ ] `fd_close` - å…³é—­æ–‡ä»¶æè¿°ç¬¦
  - [ ] `path_open` / `path_create_directory` - è·¯å¾„æ“ä½œ
  - [ ] `fd_readdir` - ç›®å½•è¯»å–
- [ ] ç¯å¢ƒè®¿é—®
  - [ ] `environ_get` / `environ_sizes_get` - ç¯å¢ƒå˜é‡
  - [ ] `args_get` / `args_sizes_get` - å‘½ä»¤è¡Œå‚æ•°
- [ ] æ—¶é’Ÿ
  - [ ] `clock_time_get` - è·å–æ—¶é—´
  - [ ] `clock_res_get` - æ—¶é’Ÿç²¾åº¦
- [ ] éšæœºæ•°
  - [ ] `random_get` - éšæœºæ•°ç”Ÿæˆ
- [ ] è¿›ç¨‹æ§åˆ¶
  - [ ] `proc_exit` - é€€å‡ºè¿›ç¨‹
  - [ ] `sched_yield` - è®©å‡º CPU

### 12.2 WASI å®‰å…¨æ¨¡å‹
- [ ] èƒ½åŠ›æœºåˆ¶ (Capability-based security)
- [ ] ç›®å½•é¢„å¼€æ”¾ (Pre-opened directories)
- [ ] æ–‡ä»¶æè¿°ç¬¦æƒé™ç®¡ç†

### 12.3 WASI CLI é›†æˆ
- [ ] `--dir <HOST_DIR[::GUEST_DIR]>` ç›®å½•æ˜ å°„
- [ ] `--env <NAME=VAL>` ç¯å¢ƒå˜é‡ä¼ é€’
- [ ] `-S, --wasi <KEY=VAL>` WASI é€‰é¡¹

---

## Phase 13: WASM æ‰©å±•ææ¡ˆ ğŸŒŸ

### 13.1 WASM 2.0+ ç‰¹æ€§
- [ ] å°¾è°ƒç”¨ (tail-call)
- [ ] å¼‚å¸¸å¤„ç† (exception-handling)
- [ ] åƒåœ¾å›æ”¶ (GC)
- [ ] ç»„ä»¶æ¨¡å‹ (Component Model)

### 13.2 SIMD æ”¯æŒ
- [ ] v128 ç±»å‹
- [ ] SIMD æŒ‡ä»¤é›†
- [ ] å‘é‡åŒ–ä¼˜åŒ–

### 13.3 çº¿ç¨‹æ”¯æŒ
- [ ] å…±äº«å†…å­˜
- [ ] åŸå­æ“ä½œ
- [ ] ç­‰å¾…/é€šçŸ¥

---

## é‡Œç¨‹ç¢‘æ—¶é—´çº¿

| é˜¶æ®µ | ç›®æ ‡ | çŠ¶æ€ |
|------|------|------|
| Phase 1-5 | å®Œæ•´çš„ WASM è§£é‡Šå™¨ | âœ… å·²å®Œæˆ |
| Phase 6 | ä¸­é—´è¡¨ç¤ºå±‚è®¾è®¡ | âœ… å·²å®Œæˆ |
| Phase 7 | IR ä¼˜åŒ– | âœ… å·²å®Œæˆ (7.4 å¯é€‰è·³è¿‡) |
| Phase 8 | æŒ‡ä»¤é€‰æ‹© | âœ… æ ¸å¿ƒå®Œæˆ (çº¦æŸç³»ç»Ÿ/å¤šè°ƒç”¨çº¦å®šå®šä¹‰ä½†æœªä½¿ç”¨) |
| Phase 9 | å¯„å­˜å™¨åˆ†é… | âœ… æ ¸å¿ƒå®Œæˆ (åˆå¹¶ä¼˜åŒ–å¾…å®ç°) |
| Phase 10 | ä»£ç ç”Ÿæˆ | âœ… æ ¸å¿ƒå®Œæˆ (8/16ä½å†…å­˜æ“ä½œã€æ‰©å±•æŒ‡ä»¤å¾…å®ç°) |
| Phase 11 | JIT é›†æˆ | ğŸ”¨ è¿›è¡Œä¸­ (OSRã€å®Œæ•´è°ƒè¯•å‘½ä»¤å¾…å®ç°) |
| Phase 12 | WASI æ”¯æŒ | ğŸ“‹ æœªæ¥è®¡åˆ’ |
| Phase 13 | WASM æ‰©å±• | ğŸ“‹ æœªæ¥è®¡åˆ’ |

---

## å‚è€ƒèµ„æº

### WebAssembly è§„èŒƒ
- [WebAssembly Specification](https://webassembly.github.io/spec/)
- [WASM Binary Encoding](https://webassembly.github.io/spec/core/binary/index.html)
- [WASM Semantics](https://webassembly.github.io/spec/core/exec/index.html)

### Cranelift å‚è€ƒ
- [Cranelift Official Site](https://cranelift.dev/)
- [Cranelift Code Generation Primer](https://bouvier.cc/2021/02/17/cranelift-codegen-primer/)
- [ISLE DSL Reference](https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/isle/docs/language-reference.md)
- [Wasmtime and Cranelift Progress](https://bytecodealliance.org/articles/wasmtime-and-cranelift-in-2023)

### ç¼–è¯‘å™¨è®¾è®¡
- [Engineering a Compiler (Cooper & Torczon)](https://www.elsevier.com/books/engineering-a-compiler/cooper/978-0-12-815412-0)
- [SSA Book](http://ssabook.gforge.inria.fr/latest/book.pdf)

---

**å½“å‰çŠ¶æ€**: Phase 8-11 æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆï¼Œéƒ¨åˆ†é«˜çº§åŠŸèƒ½ï¼ˆæ“ä½œæ•°çº¦æŸã€å¤šè°ƒç”¨çº¦å®šã€8/16ä½å†…å­˜æ“ä½œã€æ‰©å±•æŒ‡ä»¤ã€è°ƒè¯•æ­¥è¿›å‘½ä»¤ï¼‰å·²å®šä¹‰æ¥å£ä½†æœªå®ç°
**ä¸‹ä¸€æ­¥**: å®ç°å †æ ˆæ›¿æ¢ (OSR)ã€å®Œå–„ 8/16 ä½å†…å­˜æ“ä½œï¼Œæˆ–å¼€å§‹ Phase 12 WASI æ”¯æŒ
